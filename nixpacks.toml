# nixpacks.toml
# Configuração para Railway - Fullstack App (Frontend + Backend)

# Configuração da versão do Node.js
[phases.setup]
nixPkgs = ["nodejs_22"]

# Instalar dependências
[phases.install]
cmd = "npm install"

# Cache para otimizar builds
[phases.install.cache]
paths = ["node_modules"]

# Build: compila frontend (dist-client) e backend (dist-server)
[phases.build]
cmd = "npm run build"

# Start: inicia o servidor Express que serve API + static files
[start]
cmd = "node dist-server/index.cjs"
